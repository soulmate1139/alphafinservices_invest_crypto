(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[65872],{32567:(e,n,t)=>{"use strict";var i=t(97639),r=t(70617).isFunction;function s(e){if(this._listeners=new i,this._childs=[],this._muteChildChanges=!1,void 0!==e)if(this.isPrimitiveType(e))this._value=e;else for(var n in e)this.addProperty(n,e[n])}s.prototype.merge=function(e,n){var t=null;if(n)var i=(t=[]).length;if(void 0===e)return t;if(this.isPrimitiveType(e))return n&&this._value!==e&&t.push(this),this._value=e,t;if(Array.isArray(e))for(var r=0;r<e.length;r++)if(this[r]){var s=this[r].merge(e[r],n);n&&(t=t.concat(s))}else this.addProperty(r,e[r]),n&&t.push(this[r]);else for(var o in e)if(this[o]){s=this[o].merge(e[o],n);n&&void 0!==s&&(t=t.concat(s))}else this.addProperty(o,e[o]),n&&t.push(this[o]);return n&&t.length>i&&t.push(this),t},s.prototype.mergeAndFire=function(e){var n=this.merge(e,!0);this._muteChildChanges=!0,n.forEach((function(e){e._muteChildChanges=!0})),n.forEach((function(e){e._muteChildChanges=!1,e.listeners().fire(e)})),this._muteChildChanges=!1,n.length>0&&this.listeners().fire(this)},s.prototype.state=function(e){var n=r(this.value)?this.value():void 0;void 0===n&&(n={});for(var t=0;t<this._childs.length;t++){var i=this._childs[t];if(e&&-1!==e.indexOf(i))continue;const r=this[i];let c;if(e){for(var s=[],o=0;o<e.length;o++){var a=e[o];a.startsWith(i+".")&&s.push(a.substring(i.length+1))}c=r.state(s)}else c=r.state();(void 0!==c||r.storeStateIfUndefined())&&(n[i]=c)}return n},s.prototype.storeStateIfUndefined=function(){return!0},s.prototype.clone=function(e){return new s(this.state())},s.prototype.isPrimitiveType=function(e){return null===e||(!!isNumber(e)||(!!new TradingView.TypeValidator(String).check(e)||TradingView.isBoolean(e)))},s.prototype.value=function(){return this._value},s.prototype.listeners=function(){return this._listeners},s.prototype.childCount=function(){return this._childs.length},s.prototype.childNames=function(){return this._childs},s.prototype.child=function(e){return this[e]},s.prototype.setValue=function(e,n){(this._value!==e||n)&&(this._value=e,this._listeners.fire(this))},s.prototype.setValueSilently=function(e){this._value=e},s.prototype.addProperty=function(e,n){var t=new s(n);this[e]=t,this._childs.push(e),t.subscribe(this,this.childChanged)},s.prototype.removeProperty=function(e){this[e].unsubscribe(this,this.childChanged),delete this[e],this._childs=this._childs.filter((function(n){return n!==e}))},s.prototype.hasChild=function(e){return this._childs.indexOf(e)>=0},s.prototype.addChild=function(e,n){this[e]&&this[e].unsubscribe(this,this.childChanged),this[e]=n,-1===this._childs.indexOf(e)&&this._childs.push(e),n.subscribe(this,this.childChanged)},s.prototype.childChanged=function(e,n){this._muteChildChanges||this.listeners().fire(this)},s.prototype.subscribe=function(e,n){this.listeners().subscribe(e,n,!1)},s.prototype.unsubscribe=function(e,n){this.listeners().unsubscribe(e,n)},s.prototype.unsubscribeAll=function(e){this.listeners().unsubscribeAll(e)},s.prototype.childs=function(){
return this},e.exports=s},64019:(e,n,t)=>{"use strict";t.r(n),t.d(n,{normalizeIntervalString:()=>f,isAvailable:()=>h,setLastUsedResolution:()=>_,getRangeResolution:()=>v,getTimeBasedResolution:()=>m,getDefaultResolution:()=>S,getResolutionByChartStyle:()=>y,getServerInterval:()=>R,isResolutionMultiplierValid:()=>g,getMaxResolutionValue:()=>P,getResolutionsFromSettings:()=>T,convertResolutionsFromSettings:()=>w,mergeResolutions:()=>C,sortResolutions:()=>b,getCustomResolutions:()=>x,getTranslatedResolution:()=>U,getTranslatedResolutionModel:()=>E,isSecondsEnabled:()=>N,isTicksEnabled:()=>L});var i=t(87236),r=t(73044),s=t(49473),o=t(62802),a=t(83912),c=t(77809),u=t(70617);t(11688);const l={[r.ResolutionKind.Ticks]:1,[r.ResolutionKind.Seconds]:60,[r.ResolutionKind.Minutes]:1440,[r.SpecialResolutionKind.Hours]:24,[r.ResolutionKind.Days]:365,[r.ResolutionKind.Weeks]:52,[r.ResolutionKind.Months]:12,[r.ResolutionKind.Range]:1e6,[r.ResolutionKind.Invalid]:NaN},d={[r.ResolutionKind.Ticks]:0,[r.ResolutionKind.Seconds]:1,[r.ResolutionKind.Minutes]:2,[r.SpecialResolutionKind.Hours]:3,[r.ResolutionKind.Days]:4,[r.ResolutionKind.Weeks]:5,[r.ResolutionKind.Months]:6,[r.ResolutionKind.Range]:7,[r.ResolutionKind.Invalid]:8},p={[r.ResolutionKind.Invalid]:"",[r.ResolutionKind.Ticks]:(0,i.t)("T",{context:"interval_short"}),[r.ResolutionKind.Seconds]:(0,i.t)("s",{context:"interval_short"}),[r.ResolutionKind.Minutes]:(0,i.t)("m",{context:"interval_short"}),[r.SpecialResolutionKind.Hours]:(0,i.t)("h",{context:"interval_short"}),[r.ResolutionKind.Days]:(0,i.t)("D",{context:"interval_short"}),[r.ResolutionKind.Weeks]:(0,i.t)("W",{context:"interval_short"}),[r.ResolutionKind.Months]:(0,i.t)("M",{context:"interval_short"}),[r.ResolutionKind.Range]:(0,i.t)("R",{context:"interval_short"})};function f(e){return r.Interval.parse(e).value()}function h(e){const n=r.Interval.parse(e);if(n.isRange())return a.linking.range.value();const t=n.value(),i=a.linking.supportedResolutions.value();return void 0!==i?void 0!==i.find(e=>f(e)===t):n.isIntraday()?Boolean(a.linking.intraday.value()):n.isDWM()}function _(e){r.Interval.isValid(e)&&(r.Interval.isRange(e)?o.setValue("chart.lastUsedRangeResolution",e):o.setValue("chart.lastUsedTimeBasedResolution",e))}function v(e){const n=o.getValue("chart.lastUsedRangeResolution");if(void 0!==n&&r.Interval.isRange(n))return n;let t="100R";for(const n of e){const e=r.Interval.parse(n);if(e.isRange()){const n=e.value();if("100R"===n)return n;t=n}}return t}function m(e){const n=o.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==n&&r.Interval.isTimeBased(n))return n;let t="1D";for(const n of e){const e=r.Interval.parse(n);if(e.isTimeBased()){const n=e.value();if("1D"===n)return n;t=n}}return t}function S(e){return e?"100R":"1D"}function y(e,n,t){const i=s.isRangeStyle(e),o=r.Interval.isRange(n);return!i&&o?m(t):i&&!o?v(t):n}function R(e){return r.Interval.isRange(e)?"1":e}function g(e){const{interval:n,guiResolutionKind:t}=r.Interval.parseExt(e);if(!n.isValid())return!1
;return(t===r.SpecialResolutionKind.Hours?n.multiplier()/60:n.multiplier())<=A(t)}function A(e){const n=l[e];return Number.isNaN(n)?1:n}function P(e){return A(r.Interval.parseExt(e).guiResolutionKind)}function T(e){const n=w(o.getJSON(e,[]));return(0,c.uniq)(n.filter(g).map(f))}function w(e){return Array.isArray(e)?e:Object.keys(e).map(r.Interval.normalize).filter(u.notNull)}function C(...e){let n=[].concat(...e);return n=(0,c.uniq)(n.filter(g).map(f)),b(n)}function b(e){return e.sort(D)}function I(e){const n=r.Interval.parse(e),t=n.multiplier()||1;return n.isMinuteHours()?[r.SpecialResolutionKind.Hours,t/60]:[n.kind(),t]}function D(e,n){const[t,i]=I(e),[r,s]=I(n);return t!==r?d[t]-d[r]:i-s}function x(){let e=[];return window.user.is_pro&&(e=T("IntervalWidget.intervals")),e}function U(e){const{multiplier:n,shortKind:t}=E(e);return`${n}${t}`}function E(e,n){const t=r.Interval.parse(e);let i=t.multiplier(),s=t.kind();if(!t.isValid()){if(n)return null;throw new TypeError("Can't translate invalid interval")}return t.isMinuteHours()&&(i=Math.floor(i/60),s=r.SpecialResolutionKind.Hours),{multiplier:i.toString(),shortKind:O(s),hint:`${i} ${O(s,i)}`,mayOmitMultiplier:t.isDWM()&&1===i,mayOmitShortKind:t.isMinutes()&&!t.isMinuteHours()}}function O(e,n){if(!n)return p[e];switch(e){case r.ResolutionKind.Ticks:return(0,i.t)("tick",{plural:"ticks",count:n});case r.ResolutionKind.Days:return(0,i.t)("day",{plural:"days",count:n});case r.ResolutionKind.Weeks:return(0,i.t)("week",{plural:"weeks",count:n});case r.ResolutionKind.Months:return(0,i.t)("month",{plural:"months",count:n});case r.ResolutionKind.Seconds:return(0,i.t)("second",{plural:"seconds",count:n});case r.ResolutionKind.Minutes:return(0,i.t)("minute",{plural:"minutes",count:n});case r.SpecialResolutionKind.Hours:return(0,i.t)("hour",{plural:"hours",count:n});case r.ResolutionKind.Range:return(0,i.t)("range",{plural:"ranges",count:n});default:return e}}function N(){return!0}function L(){return!1}},66156:(e,n,t)=>{"use strict";var i=t(97639),r=t(23127),s=t(87236).t,o=t(88537).assert,a=t(45848).trackEvent,c=t(26722).TVXWindowEvents,u=t(11905).getLogger("Pine.ScriptLib"),l=t(75203).telemetry,d=t(51954),p={fast:["delete","get","is_auth_to_get","is_auth_to_write","parse_title","rename","lib_list"],medium:["list","eval_pine_ex","translate_light"],slow:["process_legacy","publish","save","translate","translate_source","gen_alert"]};var f={};function h(){f._cache={}}f._isAuthCache=new h,f._pineDeleted=new i,c.on("TVScriptModified",(function(e){f.clearSavedScriptsCache(),f.scriptUpdater()&&f.scriptUpdater().onTVScriptModified(JSON.parse(e))})),c.on("TVScriptDeleted",(function(e){f.clearAllCaches(),f.scriptUpdater()&&f.scriptUpdater().onTVScriptDeleted(JSON.parse(e))})),c.on("TVScriptRenamed",(function(e){f.clearSavedScriptsCache(),f.scriptUpdater()&&f.scriptUpdater().onTVScriptRenamed(JSON.parse(e))})),c.on("TVScriptLegacyPineProcessed",(function(e){f.clearSavedScriptsCache(),f.scriptUpdater()&&f.scriptUpdater().onTVScriptLegacyPineProcessed(JSON.parse(e))})),
f.PINE_FACADE_URL=function(){return window.PINE_URL},f.onPineDeleted=function(){return f._pineDeleted},f._pineFacadeAjax=function(e,n,t,i){u.logNormal("Requesting pine facade scripts, url: "+n);var s=function(e,n){for(var t=Object.keys(p),i=0;i<t.length;i++){var r=p[t[i]].filter((function(n){return-1!==e.indexOf(n)}));if(Boolean(r.length))return t[i]}return!1}(n),o=Date.now(),a=i?void 0:{withCredentials:!0};return r.ajax({url:f.PINE_FACADE_URL()+n,type:e,data:t||{},dataType:"json",xhrFields:a}).done((function(){var e=Date.now()-o;l.sendReport("pine",s+"_group_time_frame",{value:e}),l.sendReport("pine",s+"_group_ok"),u.logNormal("Requesting pine facade scripts finished, url: "+n)})).fail((function(){var e=Date.now()-o;l.sendReport("pine",s+"_group_time_frame",{value:e}),l.sendReport("pine",s+"_group_error"),u.logError("Requesting pine facade scripts failed, url: "+n)}))},f.convertScript=function(e,n){var t=r.Deferred(),i={source:e,version_to:n};return f._pineFacadeAjax("POST","/convert/",i).done((function(e,n,i){e.error?t.reject(f._readableError(e.error)):t.resolve(e)})).fail((function(e,n,i){f._anyRequestAsyncFail(t,e)})),t.promise()},f.translateScriptAsync=function(e,n,t,i){a("Pine","ScriptLib.translateScript"),i=!!i;var s=r.Deferred(),o="/translate_source/"+encodeURIComponent(n)+"/?is_pine_ex="+i,c={user_name:window.user&&window.user.username,source:e,inputs:JSON.stringify(t||{})};return f._pineFacadeAjax("POST",o,c).done((function(e,n,t){f._translateScriptAsyncDone(s,e)})).fail((function(e,n,t){f._anyRequestAsyncFail(s,e)})),s.promise()},f.translateScriptAsync2=function(e,n){u.logNormal("translateScriptAsync2, pineId="+e+" pineVersion="+n),a("Pine","ScriptLib.translateScript");var t=r.Deferred(),i=0!==e.indexOf("USER"),s=window.user&&window.user.username,o="?user_name="+encodeURIComponent(s),l="/translate/"+encodeURIComponent(e)+"/"+n+"/";return i||null==s||(l+=o),f._pineFacadeAjax("GET",l,void 0,i).done((function(e,i,r){if(f._translateScriptAsyncDone(t,e),n<0){f.clearSavedScriptsCache();var s={scriptMetaInfo:e.result.metaInfo};c.emit("TVScriptLegacyPineProcessed",JSON.stringify(s)),d.emit("TVScriptLegacyPineProcessed",s),setTimeout((function(){s.isSelfCall=!0,null!=f.scriptUpdater()&&f.scriptUpdater().onTVScriptLegacyPineProcessed(s)}),0)}})).fail((function(e,n,i){f._anyRequestAsyncFail(t,e)})),t.promise()},f._translateScriptAsyncDone=function(e,n){if(n.error)e.reject(f._readableError(n.error));else if(n.success)e.resolve(n.result.metaInfo,n.result.IL);else{var t=n.result?n.result.metaInfo:null;e.reject(n.reason,t)}},f._saveScriptAsyncDone=function(e,n){if(n.error)e.reject(f._readableError(n.error));else if(n.success)e.resolve(n.result.metaInfo);else{var t=n.result?n.result.metaInfo:null;e.resolve(t,n.reason)}},f._generateAlertAsyncDone=function(e,n){if(n.error)e.reject(f._readableError(n.error));else if(n.success)e.resolve(n.result.metaInfo,n.result.IL,n.result.inputs||null,n.result.gen_alert_data||null);else{var t=n.result?n.result.metaInfo:null;e.reject(n.reason,t)}},f._readableError=function(e,n){return n},
f._anyRequestAsyncFail=function(e,n){0===f.PINE_FACADE_URL().indexOf("http")&&u.logError(n.responseText),e.reject(f._readableError(n.status,n.statusText))},f.isAuthToWritePineScript=function(e){var n="write_"+e,t=f._isAuthCache.getPromise(n);if(null!==t)return t;a("Pine","ScriptLib.isAuthToWritePineScript");var i=r.Deferred(),s="/is_auth_to_write/"+encodeURIComponent(e);return f._pineFacadeAjax("GET",s).done((function(e,n,t){i.resolve(e)})).fail((function(e,n,t){f._anyRequestAsyncFail(i,e)})),f._isAuthCache.setPromise(n,i.promise())},f.isAuthToGetPineSourceCode=function(e,n){var t="get_"+e+"_"+n,i=f._isAuthCache.getPromise(t);if(null!==i)return i;a("Pine","ScriptLib.isAuthToGetPineSourceCode");var s=r.Deferred(),o="/is_auth_to_get/"+encodeURIComponent(e)+"/"+n;return f._pineFacadeAjax("GET",o).done((function(e,n,t){s.resolve(e)})).fail((function(e,n,t){f._anyRequestAsyncFail(s,e)})),f._isAuthCache.setPromise(t,s.promise())},h.prototype.getPromise=function(e){var n=f._cache[e];return void 0===n?null:void 0!==n.value?r.Deferred().resolve(n.value):void 0!==n.promise?n.promise:null},h.prototype.setPromise=function(e,n){return f._cache[e]={promise:n},n.done((function(n){f._cache[e]={value:n}})).fail((function(n){delete f._cache[e]})),n},f.getPineSourceCode=function(e,n,t){a("Pine","ScriptLib.getPineSourceCode");var i=r.Deferred(),s="?no_4xx="+!!t,o="/get/"+encodeURIComponent(e)+"/"+n+s;return f._pineFacadeAjax("GET",o).done((function(e,n,t){!1===e.success?i.reject(e.reason):i.resolve(e)})).fail((function(e,n,t){f._anyRequestAsyncFail(i,e)})),i.promise()},f.saveNewDraft=function(e){a("Pine","ScriptLib.saveNewDraft");var n=r.Deferred();if(null==e||""===e)return n.reject(s("Cannot save empty source code"));var t=window.user&&window.user.username,i="/save/new_draft/?user_name="+encodeURIComponent(t)+"&allow_use_existing_draft=true",o={source:e};return f._pineFacadeAjax("POST",i,o).done((function(e,t,i){f._translateScriptAsyncDone(n,e)})).fail((function(e,t,i){f._anyRequestAsyncFail(n,e)})),n.promise()},f.saveNextDraft=function(e,n,t){a("Pine","ScriptLib.saveNextDraft");var i=r.Deferred();if(null==n||""===n)return i.reject(s("Cannot save empty source code"));var o=window.user&&window.user.username,c=(t=!!t,"/save/next_draft/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(o)+"&allow_create_new="+t),u={source:n};return f._pineFacadeAjax("POST",c,u).done((function(e,n,t){f._translateScriptAsyncDone(i,e)})).fail((function(e,n,t){f._anyRequestAsyncFail(i,e)})),i.promise()},f.processLegacy=function(e,n){a("Pine","ScriptLib.processLegacy");var t=r.Deferred(),i=window.user&&window.user.username,s="/process_legacy/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(i),o={};return null!=n&&""!==n&&(o.source=n),f._pineFacadeAjax("POST",s,o).done((function(e,n,i){f._translateScriptAsyncDone(t,e)})).fail((function(e,n,i){f._anyRequestAsyncFail(t,e)})),t.promise()},f.generateAlert=function(e){a("Pine","ScriptLib.generateAlert")
;var n=r.Deferred(),t=window.user&&window.user.username,i="/gen_alert/?user_name="+encodeURIComponent(t),s={alert_info:e},o=Date.now();return f._pineFacadeAjax("POST",i,s).done((function(e,t,i){l.sendReport("alerts","compilation_ok"),f._generateAlertAsyncDone(n,e)})).fail((function(e,t,i){l.sendReport("alerts","compilation_error"),f._anyRequestAsyncFail(n,e)})).always((function(){var e=Date.now()-o;l.sendReport("alerts","compilation_time_frame",{value:e})})),n.promise()},f.parseScriptTitleAsync=function(e){a("Pine","ScriptLib.parseScriptTitle");var n=r.Deferred();if(null==e||""===e)return n.reject(s("Cannot save empty source code"));var t={user_name:window.user&&window.user.username,source:e};return f._pineFacadeAjax("POST","/parse_title/",t).done((function(e,t,i){e.error?n.reject(f._readableError(e.error)):e.success?n.resolve(e.result):n.reject(e.reason)})).fail((function(e){f._anyRequestAsyncFail(n,e)})),n.promise()},f.evalMetaInfoExprsAsync=function(e,n){a("Pine","ScriptLib.evalMetaInfoExprs");var t=r.Deferred(),i={username:window.user&&window.user.username,source:e,inputs:JSON.stringify(n||{})};return f._pineFacadeAjax("POST","/eval_pine_ex/",i).done((function(e,n,i){e.error?t.reject(f._readableError(e.error)):e.success?t.resolve(e.result):t.reject(e.reason)})).fail((function(e){f._anyRequestAsyncFail(t,e)})),t.promise()},f.patchPropertiesAsync=function(e,n,t){return u.logNormal("patchPropertiesAsync"),new Promise((function(i,r){if(n.TVScriptMetaInfoExprs){var s=n.TVScriptMetaInfoExprs.tree,a=n.TVScriptMetaInfoExprs.patchMap;f.evalMetaInfoExprsAsync(s,t).done((function(n){for(var t=n.rootValues,r=Object.keys(a),s=0;s<r.length;s++){var c=r[s],u=t[a[c]],l=c.split(".");"defaults"===l[0]&&l.splice(0,1),o(l.length>1,"Unexpectedly short json path");for(var d=e,p=0;p<l.length-1;++p)d=d[l[p]];d[l[l.length-1]].setValue(u)}i(e)})).fail((function(e){r(e)}))}else i(e)}))},f.scriptUpdater=function(){return window.scriptUpdater},f.clearAllCaches=function(){f.clearIsAuthToCaches(),f.clearSavedScriptsCache()},f.clearIsAuthToCaches=function(e){e?Object.keys(f._cache).filter((function(n){return n.indexOf(e)>=0})).forEach((function(e){delete f._cache[e]})):f._isAuthCache=new h},f.clearSavedScriptsCache=function(e){delete f._userScriptsDfd},f.requestUserScripts=function(e){if(a("Pine","ScriptLib.requestUserScripts"),window.is_authenticated){if(!f._userScriptsDfd){f._userScriptsDfd=r.Deferred();var n=f._userScriptsDfd;f._pineFacadeAjax("GET","/list?filter=saved").done((function(e,t,i){n.resolve(e)})).fail((function(e){f._anyRequestAsyncFail(n,e)}))}n=f._userScriptsDfd}else n=r.Deferred().resolve([]);return"function"==typeof e&&n.done(e),n.promise()},f.setUserScripts=function(e){f._userScriptsDfd||(f._userScriptsDfd=r.Deferred().resolve(e))},f.requestUserPublishedScripts=function(e,n){if(a("Pine","ScriptLib.requestUserPublishedScripts"),window.is_authenticated){if(n||!f._userPublishedScriptsDfd){f._userPublishedScriptsDfd=r.Deferred();var t=f._userPublishedScriptsDfd
;f._pineFacadeAjax("GET","/list?filter=published").done((function(e,n,i){t.resolve(e)})).fail((function(e){f._anyRequestAsyncFail(t,e)}))}t=f._userPublishedScriptsDfd}else t=r.Deferred().resolve([]);return"function"==typeof e&&t.done(e),t.promise()},f.requestPineEditorNewTemplateScripts=function(e){a("Pine","ScriptLib.requestPineEditorNewTemplateScripts");var n=r.Deferred();return f._pineFacadeAjax("GET","/list/?filter=template",void 0,!0).done((function(e,t,i){n.resolve(e)})).fail((function(e){f._anyRequestAsyncFail(n,e)})),"function"==typeof e&&n.done(e),n.promise()},f.requestInfoForScripts=function(e){return Promise.all([f._pineFacadeAjax("GET","/list?filter=saved"),f._pineFacadeAjax("GET","/list?filter=addon",void 0,!0)]).then((function(n){var t=n[0],i=n[1];return t.concat(i).filter((function(n){return e.includes(n.scriptIdPart)}))}))},f.requestBuiltinScripts=function(){a("Pine","ScriptLib.requestBuiltinScripts"),u.logNormal("Request built-in scripts");var e=r.Deferred();return f._pineFacadeAjax("GET","/list/?filter=standard",void 0,!0).done((function(n,t,i){u.logNormal("Request built-in scripts finished"),e.resolve(n)})).fail((function(n){u.logWarn("Request built-in scripts finished with fail"),f._anyRequestAsyncFail(e,n)})),e.promise()},f.requestBuiltinAndUserScripts=function(){a("Pine","ScriptLib.requestBuiltinAndUserScripts"),u.logNormal("Request built-in and user scripts");var e,n=window.user&&window.user.username,t={},i=new Promise((function(n,i){e=n,t.reject=i}));return Promise.all([f._pineFacadeAjax("GET","/list?filter=saved&user_name="+encodeURIComponent(n),void 0,!1),f._pineFacadeAjax("GET","/list?filter=standard",void 0,!0)]).then((function(n){u.logNormal("Request built-in and user scripts finished");var t=n[0],i=n[1];e(t.concat(i))})).catch((function(e){u.logWarn("Request built-in and user scripts finished with fail"),f._anyRequestAsyncFail(t,e)})),i},f.requestCandlestickScripts=function(){var e;a("Pine","ScriptLib.requestCandlestickScripts"),u.logNormal("Request candlestick scripts");var n={},t=new Promise((function(t,i){e=t,n.reject=i}));return f._pineFacadeAjax("GET","/list?filter=candlestick",void 0,!0).done((function(n){u.logNormal("Request candlestick scripts finished"),e(n)})).fail((function(e){u.logWarn("Request candlestick scripts finished with fail"),f._anyRequestAsyncFail(n,e)})),t};var _={time:-1/0,request:null};f.requestFundamentalScripts=function(){if(_.time+6e5>Date.now()&&null!==_.request)return u.logNormal("Return fundamentals from cache"),_.request;u.logNormal("Request fundamental scripts");var e=f._pineFacadeAjax("GET","/list?filter=fundamental",void 0,!1);return e.then((function(e){u.logNormal("Request fundamental scripts finished")})),e.fail((function(e){u.logWarn("Request fundamental scripts finished with fail, resetting cache"),_.request=null})),_.time=Date.now(),_.request=Promise.resolve(e.promise()),_.request},f.requestPineAddons=function(e){a("Pine","ScriptLib.requestPineAddons");var n=r.Deferred()
;return f._pineFacadeAjax("GET","/list?filter=addon&pine_id_prefix="+e).done((function(e){n.resolve(e)})).fail((function(e){f._anyRequestAsyncFail(n,e)})),n},f._updateAliveScriptInstances=function(e,n){var t={};t.scriptMetaInfo=e.result.metaInfo,t.scriptVersionToUpdate=n,c.emit("TVScriptModified",JSON.stringify(t)),d.emit("TVScriptModified",t),setTimeout((function(){t.isSelfCall=!0,null!=f.scriptUpdater()&&f.scriptUpdater().onTVScriptModified(t)}),0)},f.saveNew=function(e,n,t,i){a("Pine","ScriptLib.saveNew");var o=r.Deferred();if(null==e||""===e)return o.reject(s("Cannot save empty source code"));var c=window.user&&window.user.username,u=t?"&allow_overwrite=true":"",l="/save/new/?name="+encodeURIComponent(n)+"&user_name="+encodeURIComponent(c)+u,d={source:e};return f._pineFacadeAjax("POST",l,d).done((function(e,n,t){f.clearSavedScriptsCache(),f._updateAliveScriptInstances(e,i),f._saveScriptAsyncDone(o,e)})).fail((function(e,n,t){f._anyRequestAsyncFail(o,e)})),o.promise()},f.saveNext=function(e,n,t,i,o){a("Pine","ScriptLib.saveNext");var c=null!=t?"&name="+encodeURIComponent(t):"",u=r.Deferred();if(null==n||""===n)return u.reject(s("Cannot save empty source code"));var l=window.user&&window.user.username,d="/save/next/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(l)+"&allow_create_new="+!!o+c,p={source:n};return f._pineFacadeAjax("POST",d,p).done((function(e,n,t){f.clearSavedScriptsCache(),f._updateAliveScriptInstances(e,i),f._saveScriptAsyncDone(u,e)})).fail((function(e,n,t){f._anyRequestAsyncFail(u,e)})),u.promise()},f.deletePine=function(e){a("Pine","ScriptLib.deletePine");var n=r.Deferred(),t=window.user&&window.user.username,i="/delete/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(t);return f._pineFacadeAjax("POST",i).done((function(t,i,r){f.clearIsAuthToCaches(e),f.clearSavedScriptsCache(),n.resolve(t);var s={scriptIdPart:e};c.emit("TVScriptDeleted",JSON.stringify(s)),d.emit("TVScriptDeleted",s),setTimeout((function(){s.isSelfCall=!0,null!=f.scriptUpdater()&&f.scriptUpdater().onTVScriptDeleted(s),f._pineDeleted.fire(e)}),0)})).fail((function(e,t,i){f._anyRequestAsyncFail(n,e)})),n.promise()},f.renamePine=function(e,n,t){a("Pine","ScriptLib.renamePine");var i=r.Deferred(),s=window.user&&window.user.username,o="/rename/"+encodeURIComponent(e)+"/?name="+encodeURIComponent(n)+"&user_name="+encodeURIComponent(s)+"&force="+encodeURIComponent(!!t);return f._pineFacadeAjax("POST",o).done((function(t,r,s){f.clearSavedScriptsCache();var o={scriptIdPart:e,scriptName:n};c.emit("TVScriptRenamed",JSON.stringify(o)),d.emit("TVScriptRenamed",o),setTimeout((function(){o.isSelfCall=!0,null!=f.scriptUpdater()&&f.scriptUpdater().onTVScriptRenamed(o)}),0),i.resolve(t)})).fail((function(e,n,t){f._anyRequestAsyncFail(i,e)})),i.promise()},f.publishNew=function(e,n){a("Pine","ScriptLib.publishNew");var t=r.Deferred(),i=window.user&&window.user.username,s="/publish/new/?access="+encodeURIComponent(n)+"&user_name="+encodeURIComponent(i),o={source:e};return f._pineFacadeAjax("POST",s,o).done((function(e,n,i){
e.success?(f.clearSavedScriptsCache(),t.resolve(e)):t.reject(e.reason)})).fail((function(e,n,i){f._anyRequestAsyncFail(t,e)})),t.promise()},f.publishNext=function(e,n){u.logNormal("ScriptLib.publishNext","pine"),a("Pine","ScriptLib.publishNext");var t=r.Deferred(),i=window.user&&window.user.username,s="/publish/next/"+encodeURIComponent(n)+"?user_name="+encodeURIComponent(i),o={source:e};return f._pineFacadeAjax("POST",s,o).done((function(e,n,i){f.clearSavedScriptsCache(),e.success||t.reject(e.reason),t.resolve(e)})).fail((function(e,n,i){f._anyRequestAsyncFail(t,e)})),t.promise()},f.lightTranslate=function(e,n){return u.logNormal("ScriptLib.lightTranslate","pine"),a("Pine","ScriptLib.lightTranslate"),new Promise((function(t,i){var r=window.user&&window.user.username,s="/translate_light/?user_name="+encodeURIComponent(r);n&&(s+="&pine_id="+encodeURIComponent(n));var o={source:e};f._pineFacadeAjax("POST",s,o).done((function(e,n,r){if(e.success)t(e.result);else{var s=e.result&&e.result.reason||e.reason;i(s)}})).fail((function(e,n,t){f._anyRequestAsyncFail({reject:i},e)}))}))},f.getLibList=function(e,n,t){return u.logNormal("ScriptLib.getLibList","pine"),a("Pine","ScriptLib.getLibList"),new Promise((function(i,r){var s="/lib_list?lib_id_prefix="+encodeURIComponent(e);n&&(s+="&ignore_cache=true"),t&&(s+="&ignore_case=true"),f._pineFacadeAjax("GET",s).done((function(e,n,t){i(e)})).fail((function(e,n,t){f._anyRequestAsyncFail({reject:r},e)}))}))},f.getExistingLibraryInfo=async function(e){try{const n=await f.getLibList(e+"/last",!0,!0);if(!n.length)return null;const t=n[0];return{scriptIdPart:t.scriptIdPart,chartId:t.chartId,version:t.version}}catch(e){return null}},loginStateChange.subscribe(f,f.clearAllCaches),e.exports=f},81640:(e,n,t)=>{var i;e=t.nmd(e),"undefined"!=typeof window&&(i=window.TVScript=window.TVScript||{}),(i=i||{}).Access={},i.Access.ACCESS_OPEN_NO_AUTH="open_no_auth",i.Access.ACCESS_CLOSED_NO_AUTH="closed_no_auth",i.Access.ACCESS_CLOSED_NEEDS_AUTH="closed_needs_auth",i.Access.MAP_ID_TO_NAME={1:i.Access.ACCESS_OPEN_NO_AUTH,2:i.Access.ACCESS_CLOSED_NO_AUTH,3:i.Access.ACCESS_CLOSED_NEEDS_AUTH},i.Access.MAP_NAME_TO_ID={},Object.keys(i.Access.MAP_ID_TO_NAME).forEach((function(e){i.Access.MAP_NAME_TO_ID[i.Access.MAP_ID_TO_NAME[e]]=e})),i.PinePrefix={},i.PinePrefix.USER="USER;",i.PinePrefix.PUB="PUB;",i.PinePrefix.STD="STD;",i.PinePrefix.TV="TV_",i.PinePrefix.EDGR="EDGR_",i.PineType={},i.PineType.UserSaved="PineType_UserSaved",i.PineType.UserPublished="PineType_UserPublished",i.PineType.BuiltIn="PineType_BuiltIn",i.PineType.Addon="PineType_Addon",i.Type=i.Type||function(){},i.Type.VOID="void",i.Type.INTEGER="integer",i.Type.FLOAT="float",i.Type.STRING="string",i.Type.BOOL="bool",i.Type.COLOR="color",i.Type.SERIES="series",i.Type.PLOT="plot",i.Type.HLINE="hline",i.Type.BARCOLOR="barcolor",i.Type.BGCOLOR="bgcolor",i.Type.PLOTSHAPES="plotshape",i.Type.PLOTCHARS="plotchar",i.Type.PLOTARROWS="plotarrow",i.Type.NA="na",i.Type.ARRAY="array",i.TranslatorDefaultVersion=1,i.TranslatorReferenceVersioningIntroduced=4,
i.TranslatorLastVersion=5,i.pineType=function(e){return e.startsWith(i.PinePrefix.USER)?i.PineType.UserSaved:e.startsWith(i.PinePrefix.PUB)?i.PineType.UserPublished:e.startsWith(i.PinePrefix.STD)||e.startsWith(i.PinePrefix.TV)||e.startsWith(i.PinePrefix.EDGR)?i.PineType.BuiltIn:i.PineType.Addon},i.patchILTemplate=function(e,n,t){var r=t||{};return i._patchTemplate(/<(in_\d+)>/g,e,n,r)},i.decorateQuotes=function(e){if(!e)return e;var n=/([^\\']+?)(')[^']*?/g,t=e;return"'"==t.charAt(0)&&"'"==t.charAt(t.length-1)?"'"+(t=t.substr(1,t.length-2)).replace(n,"$1\\$2")+"'":t.replace(n,"$1\\$2")},i.patchInputs=function(e,n){var t={};for(var i in e)if(e.hasOwnProperty(i)){var r,s=e[i];r=s.isFake?{v:n[s.id],f:!0,t:s.type}:n[s.id],t[s.id]=r}return t},i._patchTemplate=function(e,n,t,r){var s=r||{};return n.replace(e,(function(e,n){for(var r=(n in s?s[n]:t.defaults.inputs[n]),o=0;o<t.inputs.length;++o)if(t.inputs[o].id===n)if("bool"===t.inputs[o].type)r=r?"1.0":"0.0";else if(["text","symbol","resolution","session"].indexOf(t.inputs[o].type)>=0)r="'"+i.decorateQuotes(r)+"'";else if("source"===t.inputs[o].type){var a=r.split("$");a[0]="'"+a[0]+"'",r="source("+a.join(",")+")"}return r}))},i.isStrategy=function(e){return/^\s*strategy\s*\(/m.test(e)};var r=/^\s*\/\/\s*?@version\s*?=\s*?(\S*?)\s*?$/gm,s=/^[0-9]+$/;i.extractVersion=function(e){r.lastIndex=0;var n=r.exec(e);if(null===n)return i.TranslatorDefaultVersion;var t=n[1],o=s.test(t)?Number(t):NaN;return isNaN(o)?i.TranslatorDefaultVersion:o},i.canUpgradeVersion=function(e){return e>=3&&e<i.TranslatorLastVersion},i.canDowngradeVersion=function(e){return e>=4&&e<=i.TranslatorLastVersion},e&&e.exports&&(e.exports=i)},44853:(e,n,t)=>{"use strict";t.d(n,{showGoProAlertsOnSecondsDialog:()=>r});var i=t(29588);function r(){(0,i.createGoProDialog)({feature:"alertsOnSeconds"})}},46511:(e,n,t)=>{"use strict";function i(e){let n;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)n=e;else if(e instanceof Date)n=new Date(e.valueOf());else if(Array.isArray(e)){n=[];let t=0;const r=e.length;for(;t<r;t++)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=i(e[t]))}else{n={};for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=i(e[t]))}return n}t.d(n,{deepCopy:()=>i})},20533:(e,n,t)=>{"use strict";function i(e){return"scriptTitle"in e&&"modified"in e}function r(e){return"userId"in e&&"scriptAccess"in e}function s(e){return"strategy"===e.kind}function o(e){return"library"===e.kind}t.d(n,{isSavedPineInfo:()=>i,isPubPineInfo:()=>r,isScriptStrategy:()=>s,isScriptLibrary:()=>o})}}]);